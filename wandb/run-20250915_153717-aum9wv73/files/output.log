[*] Warning: models are not being checkpoint
[*] Setting Randomness...
[2025-09-15 15:37:19,128][jax._src.xla_bridge][INFO] - Unable to initialize backend 'cuda':
[2025-09-15 15:37:19,130][jax._src.xla_bridge][INFO] - Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
[2025-09-15 15:37:19,144][jax._src.xla_bridge][INFO] - Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
[2025-09-15 15:37:19,145][jax._src.xla_bridge][WARNING] - An NVIDIA GPU may be present on this machine, but a CUDA-enabled jaxlib is not installed. Falling back to cpu.
[*] Generating MNIST Classification Dataset...
[*] Starting `s4` Training on `mnist-classification` =>> Initializing...
/home/jaxon/research/fault-injection/ssm-fault-inj/s4/train.py:131: DeprecationWarning: jax.tree_leaves is deprecated: use jax.tree.leaves (jax v0.4.25 or newer) or jax.tree_util.tree_leaves (any JAX version).
  extra_keys = set(lr_layer.keys()) - set(jax.tree_leaves(name_map(params)))
/home/jaxon/research/fault-injection/ssm-fault-inj/s4/train.py:143: DeprecationWarning: jax.tree_leaves is deprecated: use jax.tree.leaves (jax v0.4.25 or newer) or jax.tree_util.tree_leaves (any JAX version).
  print(f"[*] Trainable Parameters: {sum(jax.tree_leaves(param_sizes))}")
[*] Trainable Parameters: 397834
[*] Total training steps: 4690
[*] Starting Training Epoch 1...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [41:00<00:00,  5.25s/it]
[*] Running Epoch 1 Validation...
  0%|                                                                                                         | 0/79 [00:00<?, ?it/s]/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/flax/core/lift.py:305: RuntimeWarning: kwargs are not supported in vmap, so "compute_grad, inject_fault" is(are) ignored
  warnings.warn(msg.format(name, ', '.join(kwargs.keys())), RuntimeWarning)
 20%|███████████████████▍                                                                            | 16/79 [00:21<01:24,  1.34s/it]
Traceback (most recent call last):
  File "/home/jaxon/research/fault-injection/ssm-fault-inj/s4/train.py", line 484, in <module>
    main()
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/home/jaxon/research/fault-injection/ssm-fault-inj/s4/train.py", line 480, in main
    example_train(**cfg)
  File "/home/jaxon/research/fault-injection/ssm-fault-inj/s4/train.py", line 381, in example_train
    test_loss, test_acc = validate(
  File "/home/jaxon/research/fault-injection/ssm-fault-inj/s4/train.py", line 190, in validate
    loss, acc = eval_step(
KeyboardInterrupt
