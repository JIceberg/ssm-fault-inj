[*] Warning: models are not being checkpoint
[*] Setting Randomness...
[2025-09-15 02:23:05,929][jax._src.xla_bridge][INFO] - Unable to initialize backend 'cuda':
[2025-09-15 02:23:05,929][jax._src.xla_bridge][INFO] - Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
[2025-09-15 02:23:05,930][jax._src.xla_bridge][INFO] - Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
[2025-09-15 02:23:05,931][jax._src.xla_bridge][WARNING] - An NVIDIA GPU may be present on this machine, but a CUDA-enabled jaxlib is not installed. Falling back to cpu.
[*] Generating MNIST Classification Dataset...
[*] Starting `s4` Training on `mnist-classification` =>> Initializing...
/home/jaxon/research/fault-injection/ssm-fault-inj/s4/train.py:131: DeprecationWarning: jax.tree_leaves is deprecated: use jax.tree.leaves (jax v0.4.25 or newer) or jax.tree_util.tree_leaves (any JAX version).
  extra_keys = set(lr_layer.keys()) - set(jax.tree_leaves(name_map(params)))
/home/jaxon/research/fault-injection/ssm-fault-inj/s4/train.py:143: DeprecationWarning: jax.tree_leaves is deprecated: use jax.tree.leaves (jax v0.4.25 or newer) or jax.tree_util.tree_leaves (any JAX version).
  print(f"[*] Trainable Parameters: {sum(jax.tree_leaves(param_sizes))}")
[*] Trainable Parameters: 397834
[*] Total training steps: 4690
[*] Starting Training Epoch 1...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [35:31<00:00,  4.55s/it]
[*] Running Epoch 1 Validation...
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [01:33<00:00,  1.18s/it]
output: Traced<ShapedArray(float32[784,128])>with<BatchTrace(level=2/0)> with
  val = Traced<ShapedArray(float32[128,784,128])>with<DynamicJaxprTrace(level=1/0)>
  batch_dim = 0
output: Traced<ShapedArray(float32[784,128])>with<BatchTrace(level=2/0)> with
  val = Traced<ShapedArray(float32[128,784,128])>with<DynamicJaxprTrace(level=1/0)>
  batch_dim = 0
output: Traced<ShapedArray(float32[784,128])>with<BatchTrace(level=2/0)> with
  val = Traced<ShapedArray(float32[128,784,128])>with<DynamicJaxprTrace(level=1/0)>
  batch_dim = 0
output: Traced<ShapedArray(float32[784,128])>with<BatchTrace(level=2/0)> with
  val = Traced<ShapedArray(float32[128,784,128])>with<DynamicJaxprTrace(level=1/0)>
  batch_dim = 0
output: Traced<ShapedArray(float32[784,128])>with<BatchTrace(level=2/0)> with
  val = Traced<ShapedArray(float32[16,784,128])>with<DynamicJaxprTrace(level=1/0)>
  batch_dim = 0
output: Traced<ShapedArray(float32[784,128])>with<BatchTrace(level=2/0)> with
  val = Traced<ShapedArray(float32[16,784,128])>with<DynamicJaxprTrace(level=1/0)>
  batch_dim = 0
output: Traced<ShapedArray(float32[784,128])>with<BatchTrace(level=2/0)> with
  val = Traced<ShapedArray(float32[16,784,128])>with<DynamicJaxprTrace(level=1/0)>
  batch_dim = 0
output: Traced<ShapedArray(float32[784,128])>with<BatchTrace(level=2/0)> with
  val = Traced<ShapedArray(float32[16,784,128])>with<DynamicJaxprTrace(level=1/0)>
  batch_dim = 0

=>> Epoch 1 Metrics ===
	Train Loss: 0.83870 -- Train Accuracy: 0.7196
	 Test Loss: 475213420182524571996095908937728.00000 --  Test Accuracy: 0.3495
	Best Test Loss: 475213420182524571996095908937728.00000 -- Best Test Accuracy: 0.3495 at Epoch 1

[*] Starting Training Epoch 2...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [35:17<00:00,  4.52s/it]
[*] Running Epoch 2 Validation...
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [01:30<00:00,  1.15s/it]

=>> Epoch 2 Metrics ===
	Train Loss: 0.13897 -- Train Accuracy: 0.9590
	 Test Loss: 1305526149442690164369913722961920.00000 --  Test Accuracy: 0.2285
	Best Test Loss: 475213420182524571996095908937728.00000 -- Best Test Accuracy: 0.3495 at Epoch 1

[*] Starting Training Epoch 3...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [35:27<00:00,  4.54s/it]
[*] Running Epoch 3 Validation...
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [01:29<00:00,  1.14s/it]

=>> Epoch 3 Metrics ===
	Train Loss: 0.08779 -- Train Accuracy: 0.9739
	 Test Loss: 752470943533022197683760111026176.00000 --  Test Accuracy: 0.2149
	Best Test Loss: 475213420182524571996095908937728.00000 -- Best Test Accuracy: 0.3495 at Epoch 1

[*] Starting Training Epoch 4...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [35:33<00:00,  4.55s/it]
[*] Running Epoch 4 Validation...
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [01:30<00:00,  1.15s/it]

=>> Epoch 4 Metrics ===
	Train Loss: 0.06681 -- Train Accuracy: 0.9795
	 Test Loss: 834720762940677237855798461202432.00000 --  Test Accuracy: 0.1932
	Best Test Loss: 475213420182524571996095908937728.00000 -- Best Test Accuracy: 0.3495 at Epoch 1

[*] Starting Training Epoch 5...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [35:39<00:00,  4.56s/it]
[*] Running Epoch 5 Validation...
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [01:30<00:00,  1.15s/it]

=>> Epoch 5 Metrics ===
	Train Loss: 0.05570 -- Train Accuracy: 0.9831
	 Test Loss: 607935331617510079024180043448320.00000 --  Test Accuracy: 0.2108
	Best Test Loss: 475213420182524571996095908937728.00000 -- Best Test Accuracy: 0.3495 at Epoch 1

[*] Starting Training Epoch 6...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [35:39<00:00,  4.56s/it]
[*] Running Epoch 6 Validation...
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [01:30<00:00,  1.14s/it]

=>> Epoch 6 Metrics ===
	Train Loss: 0.04687 -- Train Accuracy: 0.9851
	 Test Loss: 714241111353568450043126900326400.00000 --  Test Accuracy: 0.2205
	Best Test Loss: 475213420182524571996095908937728.00000 -- Best Test Accuracy: 0.3495 at Epoch 1

[*] Starting Training Epoch 7...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [35:47<00:00,  4.58s/it]
[*] Running Epoch 7 Validation...
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [01:29<00:00,  1.14s/it]

=>> Epoch 7 Metrics ===
	Train Loss: 0.03929 -- Train Accuracy: 0.9881
	 Test Loss: 838512109053493625620211391528960.00000 --  Test Accuracy: 0.2030
	Best Test Loss: 475213420182524571996095908937728.00000 -- Best Test Accuracy: 0.3495 at Epoch 1

[*] Starting Training Epoch 8...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [35:43<00:00,  4.57s/it]
[*] Running Epoch 8 Validation...
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [01:30<00:00,  1.14s/it]

=>> Epoch 8 Metrics ===
	Train Loss: 0.03493 -- Train Accuracy: 0.9892
	 Test Loss: 808246409374277461305607334133760.00000 --  Test Accuracy: 0.2389
	Best Test Loss: 475213420182524571996095908937728.00000 -- Best Test Accuracy: 0.3495 at Epoch 1

[*] Starting Training Epoch 9...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [35:45<00:00,  4.57s/it]
[*] Running Epoch 9 Validation...
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [01:29<00:00,  1.14s/it]

=>> Epoch 9 Metrics ===
	Train Loss: 0.03281 -- Train Accuracy: 0.9897
	 Test Loss: 910012276130014066175163196506112.00000 --  Test Accuracy: 0.2543
	Best Test Loss: 475213420182524571996095908937728.00000 -- Best Test Accuracy: 0.3495 at Epoch 1

[*] Starting Training Epoch 10...
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [36:03<00:00,  4.61s/it]
[*] Running Epoch 10 Validation...
100%|████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [01:29<00:00,  1.14s/it]

=>> Epoch 10 Metrics ===
	Train Loss: 0.02885 -- Train Accuracy: 0.9912
	 Test Loss: 602849216280479866496623400976384.00000 --  Test Accuracy: 0.3210
	Best Test Loss: 475213420182524571996095908937728.00000 -- Best Test Accuracy: 0.3495 at Epoch 1
