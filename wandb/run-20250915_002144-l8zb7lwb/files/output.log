[*] Setting Randomness...
[2025-09-15 00:21:45,666][jax._src.xla_bridge][INFO] - Unable to initialize backend 'cuda':
[2025-09-15 00:21:45,666][jax._src.xla_bridge][INFO] - Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
[2025-09-15 00:21:45,671][jax._src.xla_bridge][INFO] - Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
[2025-09-15 00:21:45,672][jax._src.xla_bridge][WARNING] - An NVIDIA GPU may be present on this machine, but a CUDA-enabled jaxlib is not installed. Falling back to cpu.
[*] Generating MNIST Classification Dataset...
[*] Starting `s4` Training on `mnist-classification` =>> Initializing...
Traceback (most recent call last):
  File "/home/jaxon/research/fault-injection/ssm-fault-inj/s4/train.py", line 469, in <module>
    main()
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/home/jaxon/research/fault-injection/ssm-fault-inj/s4/train.py", line 465, in main
    example_train(**cfg)
  File "/home/jaxon/research/fault-injection/ssm-fault-inj/s4/train.py", line 342, in example_train
    state = create_train_state(
  File "/home/jaxon/research/fault-injection/ssm-fault-inj/s4/train.py", line 75, in create_train_state
    params = model.init(
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 179, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/flax/linen/module.py", line 2464, in init
    _, v_out = self.init_with_output(
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 179, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/flax/linen/module.py", line 2316, in init_with_output
    return init_with_output(
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/flax/core/scope.py", line 1137, in wrapper
    return apply(fn, mutable=mutable, flags=init_flags)(
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/flax/core/scope.py", line 1101, in wrapper
    y = fn(root, *args, **kwargs)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/flax/linen/module.py", line 3103, in scope_fn
    return fn(module.clone(parent=scope, _deep_clone=True), *args, **kwargs)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/flax/linen/transforms.py", line 378, in wrapped_fn
    ret = trafo_fn(module_scopes, *args, **kwargs)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/flax/core/lift.py", line 325, in wrapper
    y, out_variable_groups_xs_t = fn(
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/flax/core/lift.py", line 852, in inner
    y, vars_out = mapped(variable_groups, rng_groups, args)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 179, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/jax/_src/api.py", line 1214, in vmap_f
    out_flat = batching.batch(
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/jax/_src/linear_util.py", line 192, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/flax/core/lift.py", line 848, in mapped
    y = fn(scope, *args)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/flax/linen/transforms.py", line 370, in core_fn
    res = fn(cloned, *args, **kwargs)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/flax/linen/module.py", line 701, in wrapped_module_method
    return self._call_wrapped_method(fun, args, kwargs)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/flax/linen/module.py", line 1233, in _call_wrapped_method
    y = run_fun(self, *args, **kwargs)
  File "/home/jaxon/research/fault-injection/ssm-fault-inj/s4/s4.py", line 619, in __call__
    x = layer(x)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/flax/linen/module.py", line 701, in wrapped_module_method
    return self._call_wrapped_method(fun, args, kwargs)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/flax/linen/module.py", line 1233, in _call_wrapped_method
    y = run_fun(self, *args, **kwargs)
  File "/home/jaxon/research/fault-injection/ssm-fault-inj/s4/s4.py", line 548, in __call__
    x = self.seq(x)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/flax/linen/transforms.py", line 378, in wrapped_fn
    ret = trafo_fn(module_scopes, *args, **kwargs)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/flax/core/lift.py", line 325, in wrapper
    y, out_variable_groups_xs_t = fn(
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/flax/core/lift.py", line 852, in inner
    y, vars_out = mapped(variable_groups, rng_groups, args)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 179, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/jax/_src/api.py", line 1214, in vmap_f
    out_flat = batching.batch(
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/jax/_src/linear_util.py", line 192, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/flax/core/lift.py", line 848, in mapped
    y = fn(scope, *args)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/flax/linen/transforms.py", line 370, in core_fn
    res = fn(cloned, *args, **kwargs)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/flax/linen/module.py", line 701, in wrapped_module_method
    return self._call_wrapped_method(fun, args, kwargs)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/flax/linen/module.py", line 1211, in _call_wrapped_method
    self._try_setup()
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/flax/linen/module.py", line 1506, in _try_setup
    self.setup()
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/flax/linen/module.py", line 701, in wrapped_module_method
    return self._call_wrapped_method(fun, args, kwargs)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/flax/linen/module.py", line 1233, in _call_wrapped_method
    y = run_fun(self, *args, **kwargs)
  File "/home/jaxon/research/fault-injection/ssm-fault-inj/s4/s4.py", line 1291, in setup
    self.K = kernel_DPLR(
  File "/home/jaxon/research/fault-injection/ssm-fault-inj/s4/s4.py", line 1007, in kernel_DPLR
    atRoots = c * (k00 - k01 * (1.0 / (1.0 + k11)) * k10)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/jax/_src/numpy/array_methods.py", line 739, in op
    return getattr(self.aval, f"_{name}")(self, *args)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/jax/_src/numpy/array_methods.py", line 265, in deferring_binary_op
    return binary_op(*args)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 179, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/jax/_src/pjit.py", line 327, in cache_miss
    outs, out_flat, out_tree, args_flat, jaxpr, attrs_tracked = _python_pjit_helper(
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/jax/_src/pjit.py", line 185, in _python_pjit_helper
    out_flat = pjit_p.bind(*args_flat, **params)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/jax/_src/core.py", line 2834, in bind
    return self.bind_with_trace(top_trace, args, params)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/jax/_src/core.py", line 420, in bind_with_trace
    out = trace.process_primitive(self, map(trace.full_raise, args), params)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/jax/_src/interpreters/batching.py", line 433, in process_primitive
    val_out, dim_out = batched_primitive(vals_in, dims_in, **params)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/jax/_src/pjit.py", line 1895, in _pjit_batcher
    vals_out = pjit_p.bind(
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/jax/_src/core.py", line 2834, in bind
    return self.bind_with_trace(top_trace, args, params)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/jax/_src/core.py", line 420, in bind_with_trace
    out = trace.process_primitive(self, map(trace.full_raise, args), params)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/jax/_src/core.py", line 921, in process_primitive
    return primitive.impl(*tracers, **params)
  File "/home/jaxon/miniconda3/envs/ssm-faults/lib/python3.9/site-packages/jax/_src/pjit.py", line 1635, in _pjit_call_impl
    return xc._xla.pjit(
KeyboardInterrupt
